<!DOCTYPE html>
<html>
<head>
    <title>StepFun TTS API Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #1a1a1a; color: white; }
        .container { max-width: 600px; margin: 0 auto; }
        .input-group { margin: 15px 0; }
        input, textarea, select, button { 
            width: 100%; 
            padding: 10px; 
            margin: 5px 0; 
            background: #333; 
            border: 1px solid #555; 
            color: white; 
            border-radius: 5px;
        }
        button { background: #4CAF50; cursor: pointer; }
        button:disabled { background: #666; cursor: not-allowed; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #4CAF50; }
        .error { background: #f44336; }
        .info { background: #2196F3; }
        audio { width: 100%; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>StepFun TTS API 测试</h1>
        
        <div class="input-group">
            <label>API Key:</label>
            <input type="password" id="api-key" value="6oxozA0zB7AzTjPwSvmV6SHsYUm0O0GDjx0TSKUupL8iaUousXOtqmfUzuMG9HgT2">
        </div>
        
        <div class="input-group">
            <label>选择声音:</label>
            <select id="voice-select">
                <option value="linjiajiejie">林姐姐 - 温柔女声</option>
                <option value="zhongqiu">中秋 - 温暖女声</option>
                <option value="xiaoqi">小七 - 活泼女声</option>
                <option value="yunhao">云浩 - 沉稳男声</option>
                <option value="zhiqiang">志强 - 有力男声</option>
            </select>
        </div>
        
        <div class="input-group">
            <label>测试文本:</label>
            <textarea id="test-text" rows="3">欢迎来到 LLMTANKWORLD！这是一场精彩的坦克对战！</textarea>
        </div>
        
        <button id="tts-btn" onclick="testTTS()">语音合成</button>
        
        <div id="status"></div>
        <div id="audio-container"></div>
    </div>

    <script>
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        async function testTTS() {
            const apiKey = document.getElementById('api-key').value.trim();
            const text = document.getElementById('test-text').value.trim();
            const voice = document.getElementById('voice-select').value;
            
            if (!apiKey || !text) {
                showStatus('请填写 API Key 和测试文本', 'error');
                return;
            }
            
            try {
                showStatus('正在合成语音...', 'info');
                
                const response = await fetch('https://api.stepfun.com/v1/audio/speech', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'step-1o-audio',
                        input: text,
                        voice: voice,
                        response_format: 'mp3'
                    })
                });
                
                if (response.ok) {
                    const audioBlob = await response.blob();
                    const audioUrl = URL.createObjectURL(audioBlob);
                    
                    const audioContainer = document.getElementById('audio-container');
                    audioContainer.innerHTML = `
                        <audio controls>
                            <source src="${audioUrl}" type="audio/mpeg">
                            您的浏览器不支持音频播放。
                        </audio>
                    `;
                    
                    showStatus(`✅ 语音合成成功！声音: ${voice}`, 'success');
                } else {
                    const error = await response.json();
                    showStatus(`❌ 合成失败: ${error.error?.message || response.status}`, 'error');
                }
            } catch (error) {
                showStatus(`❌ 网络错误: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html>